/*

"Introduction" - Plugin for tinyMCE 4.X
by Quastl
V. 0.5 (not ready yet)

*/

tinymce.PluginManager.add("introduction", function(editor) {
	var breakOn = false;
	var breakOff = true;
	// Add button that inserts the div
	editor.addButton("introduction1", {
		text: "Insert mark",
		icon: false,
		onclick: function() {
			// Insert the div where cursor is placed
			breakOn = editor.execCommand("mceInsertContent", false, "<div id='intMark' style='border:1px dotted #FF0; height: 2px'></div>");
			// If callback is true, the div has been set
			if(breakOn) {
				breakOff = false;
			}
		}
	});

	// Add button that deletes the div
	editor.addButton("introduction2", {
		text: "Delete mark",
		icon: false,
		onclick: function() {
			// Search the content for the div and delete it
			var content = editor.getContent();
			content = content.replace('<div id="intMark" style="border: 1px dotted #FF0; height: 2px;">&nbsp;</div>', '');
			breakOff = editor.setContent(content);
			// If callback is true, the div has been deleted
			if(breakOff) {
				breakOn = false;
			}
		}
	});
	// Now check the status and hide/show or disable/enable the buttons
	if((breakOn) && (!breakOff)) {
		// The div has been set
		// TODO
	} else if ((breakOff) && (!breakOn)) {
		// The div has been deleted
		// TODO
	} else {
		// Should never reach this part of code...
		alert("Something's not as expected!");
	}
});
