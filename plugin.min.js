/*

"Introduction" - Plugin for tinyMCE 4.X
by Quastl
V 1.0 (not ready yet)

*/

tinymce.PluginManager.add("introduction", function(editor) {
	// Add button that inserts the mark
	editor.addButton("introduction1", {
		text: "Set Introduction Marker",
		icon: false,
		onclick: function() {
			// Insert the marker and fire event1
			editor.execCommand("mceInsertContent", false, "<div id='break' style='border:1px dotted #FF0; height: 2px'></div>");
			editor.fire("event1", {state: false});
			editor.fire("event2", {state: true});
		},
		// Waiting for custom events to fire (change visible states of the buttons)
		onPostRender: function() {
			var ctrl = this;
			editor.on("event1", function(e) {
				ctrl.visible(e.state);
			});
		}
	});

	// Add button that deletes the mark
	editor.addButton("introduction2", {
		text: "Delete Introduction Marker",
		icon: false,
		visible: false,
		onclick: function() {
			// Delete the marker and fire event1
			var content = editor.getContent();
			content = content.replace('<div id="break" style="border: 1px dotted #FF0; height: 2px;">&nbsp;</div>', '');
			editor.setContent(content);
			editor.fire("event1", {state: true});
			editor.fire("event2", {state: false});
		},
		// Waiting for custom events to fire (change visible states of the buttons)
		onPostRender: function() {
			var ctrl = this;
			editor.on("event2", function(e) {
				ctrl.visible(e.state);
			});
		}
	});
});
